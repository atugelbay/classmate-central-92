# üî• –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CRM —Å–∏—Å—Ç–µ–º—ã

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π.

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### Windows (—á–µ—Ä–µ–∑ Chocolatey):
```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Chocolatey –µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (https://chocolatey.org/install)
# –ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ k6:
choco install k6
```

### –ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ –Ω–∞–ø—Ä—è–º—É—é:
–°–∫–∞—á–∞–π—Ç–µ —Å [GitHub Releases](https://github.com/grafana/k6/releases) –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ PATH.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à backend –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
cd backend
go run cmd/api/main.go
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç:
```bash
k6 run load-test.js
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Railway/Ngrok URL

```bash
# –î–ª—è Railway
k6 run -e API_URL=https://–≤–∞—à-backend.up.railway.app load-test.js

# –î–ª—è Ngrok
k6 run -e API_URL=https://abc123.ngrok-free.app load-test.js
```

---

## üìä –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
‚úì Checks.........................: 98.5% (1234/1252)
‚úì HTTP requests..................: 5000
‚úì HTTP request duration..........: avg=145ms min=23ms max=890ms
‚úì HTTP request duration (p95)....: 450ms
‚úì HTTP request failed............: 1.5%
‚úì Iterations.....................: 500
‚úì VUs............................: 200 max
```

### –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç:

- **Checks**: –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å >95%)
- **HTTP requests**: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- **HTTP request duration**: 
  - `avg` - —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (—Ö–æ—Ä–æ—à–æ: <300ms)
  - `p95` - 95% –∑–∞–ø—Ä–æ—Å–æ–≤ –±—ã—Å—Ç—Ä–µ–µ —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (—Ö–æ—Ä–æ—à–æ: <500ms)
- **HTTP request failed**: –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å <5%)
- **VUs**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–µ–±–æ–ª—å—à–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (10-50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
```javascript
export const options = {
  stages: [
    { duration: '1m', target: 10 },
    { duration: '3m', target: 50 },
    { duration: '1m', target: 0 },
  ],
};
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°—Ä–µ–¥–Ω—è—è –Ω–∞–≥—Ä—É–∑–∫–∞ (50-100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
```javascript
export const options = {
  stages: [
    { duration: '1m', target: 50 },
    { duration: '5m', target: 100 },
    { duration: '1m', target: 0 },
  ],
};
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (100-200 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
```javascript
export const options = {
  stages: [
    { duration: '2m', target: 100 },
    { duration: '5m', target: 200 },
    { duration: '2m', target: 0 },
  ],
};
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç (–ø–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)
```javascript
export const options = {
  stages: [
    { duration: '30s', target: 50 },
    { duration: '1m', target: 200 },
    { duration: '30s', target: 500 },  // –ü–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞!
    { duration: '1m', target: 0 },
  ],
};
```

---

## üîß –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ—Å—Ç–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `load-test.js`:

```javascript
// –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
const customRes = http.get(`${BASE_URL}/api/–≤–∞—à-—ç–Ω–¥–ø–æ–∏–Ω—Ç`, {
  headers,
  tags: { name: 'YourEndpoint' },
});

check(customRes, {
  'custom status 200': (r) => r.status === 200,
});
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ POST –∑–∞–ø—Ä–æ—Å–æ–≤

```javascript
const createRes = http.post(
  `${BASE_URL}/api/students`,
  JSON.stringify({
    name: 'Test Student',
    email: `student${Date.now()}@test.com`,
    phone: '+7 777 123 4567',
  }),
  {
    headers,
    tags: { name: 'CreateStudent' },
  }
);

check(createRes, {
  'create status 201': (r) => r.status === 201,
});
```

---

## üìà –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### –ó–∞–ø—É—Å–∫ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏

```bash
k6 run --out json=test-results.json load-test.js
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ k6 Cloud (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
k6 login cloud
k6 run --out cloud load-test.js
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Grafana + InfluxDB –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "too many open files"
**Windows:**
–£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç—ã –≤ —Ä–µ–µ—Å—Ç—Ä–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ WSL2.

### –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ—â–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
2. –ù–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã
3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ –ë–î
4. –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω connection pool

**–†–µ—à–µ–Ω–∏—è:**
```go
// –í backend/internal/database/database.go
db.SetMaxOpenConns(100)  // –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
db.SetMaxIdleConns(10)
db.SetConnMaxLifetime(time.Hour)
```

### –í—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –õ–æ–≥–∏ backend —Å–µ—Ä–≤–µ—Ä–∞
2. –õ–∏–º–∏—Ç—ã Railway (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω)
3. Rate limiting –≤ middleware
4. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–ª—è –º–∞–ª–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞ (10-50 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: <300ms
- ‚úÖ P95: <500ms
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫: <1%

### –î–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞ (50-100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: <500ms
- ‚úÖ P95: <1000ms
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫: <2%

### –î–ª—è –∫—Ä—É–ø–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞ (100-200+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: <800ms
- ‚úÖ P95: <2000ms
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫: <5%
- ‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤)

---

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```sql
-- –î–æ–±–∞–≤—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –ø–æ–ª–µ–π
CREATE INDEX idx_students_email ON students(email);
CREATE INDEX idx_lessons_date ON lessons(start_time);
CREATE INDEX idx_leads_status ON leads(status);
```

### 2. Backend
```go
// –í–∫–ª—é—á–∏—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis –¥–ª—è —Å–µ—Å—Å–∏–π
// –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ SQL –∑–∞–ø—Ä–æ—Å—ã (–∏–∑–±–µ–≥–∞–π—Ç–µ N+1)
```

### 3. Frontend
```typescript
// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ React Query –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
// –í–∫–ª—é—á–∏—Ç–µ lazy loading –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
// –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ bundle size
```

---

## üìù –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–∑–¥–∞–π—Ç–µ –æ—Ç—á–µ—Ç:

```bash
k6 run --summary-export=report.json load-test.js
```

–û—Ç—á–µ—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ (–ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏)
- –ü–∏–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- RPS (requests per second)

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
- ‚úÖ –í—ã—è–≤–ª—è—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è –≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º

–£–¥–∞—á–∏ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º! üöÄ

