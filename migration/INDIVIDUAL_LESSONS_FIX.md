# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π

## –ü—Ä–æ–±–ª–µ–º–∞

–†–∞–Ω—å—à–µ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑ AlfaCRM –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å **—Ñ–µ–π–∫–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã** —Å ID –≤–∏–¥–∞ `ind_12345` –∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —Ç–∏–ø–∞ `"–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (–∏–Ω–¥–∏–≤–∏–¥.)"`. 

–≠—Ç–æ –±—ã–ª–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ:
- ‚ùå –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –∫–∞–∫ –≥—Ä—É–ø–ø–æ–≤—ã–µ
- ‚ùå –í —Å–ø–∏—Å–∫–µ –≥—Ä—É–ø–ø –ø–æ—è–≤–ª—è–ª–∏—Å—å –¥–µ—Å—è—Ç–∫–∏ —Ñ–µ–π–∫–æ–≤—ã—Ö –≥—Ä—É–ø–ø
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã–ª–æ –æ—Ç–ª–∏—á–∏—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–µ –≥—Ä—É–ø–ø—ã –æ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π
- ‚ùå –ù–∞—Ä—É—à–∞–ª–∞—Å—å –ª–æ–≥–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ = –±–µ–∑ –≥—Ä—É–ø–ø—ã)

## –†–µ—à–µ–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è –º–∏–≥—Ä–∏—Ä—É—é—Ç—Å—è **–ø—Ä–∞–≤–∏–ª—å–Ω–æ**:

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

1. **–£—Ä–æ–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é** —Å `group_id = NULL` (–±–µ–∑ –≥—Ä—É–ø–ø—ã)
2. **–°–≤—è–∑—å —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–º** —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É `lesson_students`
3. **–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞** –≤–∫–ª—é—á–∞–µ—Ç –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞: `"–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"`
4. **–§–µ–π–∫–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã –±–æ–ª—å—à–µ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è**

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

**–ì—Ä—É–ø–ø–æ–≤–æ–π —É—Ä–æ–∫:**
```sql
lessons:
  - id: "uuid"
  - group_id: "group_123"  -- ‚úÖ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –≥—Ä—É–ø–ø–µ
  - title: "–ó–∞–Ω—è—Ç–∏–µ"

lesson_students:
  - lesson_id: "uuid"
  - student_id: "student_1"
  - student_id: "student_2"
```

**–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —É—Ä–æ–∫:**
```sql
lessons:
  - id: "uuid"
  - group_id: NULL  -- ‚úÖ –ë–ï–ó –≥—Ä—É–ø–ø—ã!
  - title: "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"

lesson_students:
  - lesson_id: "uuid"
  - student_id: "student_1"  -- —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å—Ç—É–¥–µ–Ω—Ç
```

## –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ï—Å–ª–∏ –≤—ã –µ—â–µ **–Ω–µ –∑–∞–ø—É—Å–∫–∞–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—é** –∏–ª–∏ –≥–æ—Ç–æ–≤—ã **–ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É**:

```bash
# –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
cd migration
node migrate-from-alfacrm.js
```

–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! ‚úÖ

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û—á–∏—Å—Ç–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è —É–∂–µ –±—ã–ª–∞ –∑–∞–ø—É—â–µ–Ω–∞ –∏ –µ—Å—Ç—å —Ñ–µ–π–∫–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã:

```bash
cd migration

# 1. –£–¥–∞–ª–∏—Ç—å —Ñ–µ–π–∫–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã
node cleanup-fake-groups.js

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ
node migrate-from-alfacrm.js
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –°–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –±–∞–∑—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º `cleanup-fake-groups.js`!

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —Ñ–µ–π–∫–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã:

```sql
SELECT id, name, description 
FROM groups 
WHERE id LIKE 'ind_%' 
  AND description LIKE '%–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–Ω–æ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏%';
```

–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç **–ø—É—Å—Ç–æ–π** ‚Üí –≤—Å—ë —Ö–æ—Ä–æ—à–æ! ‚úÖ

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏:

```sql
SELECT id, title, group_id, teacher_id 
FROM lessons 
WHERE group_id IS NULL
ORDER BY start_time DESC
LIMIT 10;
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Ä–æ–∫–∏ —Å:
- ‚úÖ `group_id = NULL`
- ‚úÖ `title` —Å–æ–¥–µ—Ä–∂–∏—Ç "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ:"

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑–∏ —Å—Ç—É–¥–µ–Ω—Ç-—É—Ä–æ–∫:

```sql
SELECT 
  l.id, 
  l.title, 
  s.name as student_name
FROM lessons l
JOIN lesson_students ls ON l.id = ls.lesson_id
JOIN students s ON ls.student_id = s.id
WHERE l.group_id IS NULL
LIMIT 10;
```

–ö–∞–∂–¥—ã–π –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —É—Ä–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–≤—è–∑–∞–Ω —Ç–æ–ª—å–∫–æ —Å **–æ–¥–Ω–∏–º —Å—Ç—É–¥–µ–Ω—Ç–æ–º**. ‚úÖ

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

‚úÖ **–ß–∏—Å—Ç–æ—Ç–∞ –¥–∞–Ω–Ω—ã—Ö** - –Ω–µ—Ç —Ñ–µ–π–∫–æ–≤—ã—Ö –≥—Ä—É–ø–ø –≤ —Å–∏—Å—Ç–µ–º–µ  
‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –≥—Ä—É–ø–ø–æ–≤—ã–µ –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ª–µ–≥–∫–æ —Ä–∞–∑–ª–∏—á–∏—Ç—å  
‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - —Å—Ç–∞—Ç—É—Å—ã "–ê–∫—Ç–∏–≤–Ω—ã–π/–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π" —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ  
‚úÖ **–£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π  
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ–∏—á–∏ –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —É—Ä–æ–∫–æ–≤  

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

- ‚úèÔ∏è `migrate-from-alfacrm.js` - —Ñ—É–Ω–∫—Ü–∏—è `migrateIndividualLessons()`
- üÜï `cleanup-fake-groups.js` - —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ —Ñ–µ–π–∫–æ–≤—ã—Ö –≥—Ä—É–ø–ø
- üìÑ `INDIVIDUAL_LESSONS_FIX.md` - —ç—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–∞–∫ –æ—Ç–ª–∏—á–∏—Ç—å –≥—Ä—É–ø–ø–æ–≤–æ–π —É—Ä–æ–∫ –æ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ?

**–í –∫–æ–¥–µ (TypeScript):**
```typescript
const lesson = { id: "...", group_id: "group_123" or null };

if (lesson.group_id) {
  console.log("–ì—Ä—É–ø–ø–æ–≤–æ–π —É—Ä–æ–∫");
} else {
  console.log("–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —É—Ä–æ–∫");
}
```

**–í SQL:**
```sql
-- –ì—Ä—É–ø–ø–æ–≤—ã–µ —É—Ä–æ–∫–∏
SELECT * FROM lessons WHERE group_id IS NOT NULL;

-- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏
SELECT * FROM lessons WHERE group_id IS NULL;
```

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏?

- üì± **–°—Ç—Ä–∞–Ω–∏—Ü–∞ "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ"** (`/individual-lessons`) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º–∏ –∑–∞–Ω—è—Ç–∏—è–º–∏
- üìÖ **–°—Ç—Ä–∞–Ω–∏—Ü–∞ "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ"** - –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –≥—Ä—É–ø–ø–æ–≤—ã–º–∏
- üë®‚Äçüéì **–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞** - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –µ–≥–æ –∑–∞–Ω—è—Ç–∏–π
- üë®‚Äçüè´ **–°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—á–∏—Ç–µ–ª—è** - —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–µ—Ä—Å–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î –∑–∞–ø—Ä–æ—Å–∞–º–∏ –≤—ã—à–µ

---

üìÖ –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 26 –æ–∫—Ç—è–±—Ä—è 2025  
‚úçÔ∏è –ê–≤—Ç–æ—Ä: AI Assistant  
üè∑Ô∏è –í–µ—Ä—Å–∏—è: 1.0

