# –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ AlfaCRM –≤ SmartCRM

–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å–∏—Å—Ç–µ–º—ã AlfaCRM –≤ SmartCRM.

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ AlfaCRM (s20.online) –≤ SmartCRM. –ú–∏–≥—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ—Ö –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π, —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –≥—Ä—É–ø–ø—ã, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –±–∞–ª–∞–Ω—Å—ã.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è **–æ–¥–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏** (tenant)
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–æ–ª–∏—Ä—É—é—Ç—Å—è –ø–æ `company_id`
- –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç —Ç–æ–ª—å–∫–æ –±–ª–∏–∂–∞–π—à–∏–µ 2 –Ω–µ–¥–µ–ª–∏ —É—Ä–æ–∫–æ–≤ (–Ω–µ –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- PostgreSQL
- –î–æ—Å—Ç—É–ø –∫ AlfaCRM API

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
# AlfaCRM API
ALFACRM_API_URL=https://–≤–∞—à-—Ñ–∏–ª–∏–∞–ª.s20.online
ALFACRM_EMAIL=–≤–∞—à@email.com
ALFACRM_API_KEY=–≤–∞—à_api_key

# PostgreSQL
DB_HOST=localhost
DB_PORT=5432
DB_NAME=classmate_central
DB_USER=postgres
DB_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –µ–¥–∏–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
node migrate-from-alfacrm.js
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∏—Ä—É–µ—Ç **–≤—Å–µ –¥–∞–Ω–Ω—ã–µ** –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:

1. ‚úÖ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ (Teachers)
2. ‚úÖ –ö–æ–º–Ω–∞—Ç—ã (Rooms)
3. ‚úÖ –¢–∏–ø—ã –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ (Tariffs)
4. ‚úÖ –ì—Ä—É–ø–ø—ã (Groups)
5. ‚úÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏—è –≥—Ä—É–ø–ø (Group Schedules)
6. ‚úÖ –°—Ç—É–¥–µ–Ω—Ç—ã + –±–∞–ª–∞–Ω—Å—ã (Students + Balances)
7. ‚úÖ –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (Student Subscriptions)
8. ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (Payment Transactions)
9. ‚úÖ –î–æ–ª–≥–∏ (Debt Records)
10. ‚úÖ –ó–∞–Ω—è—Ç–∏—è –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏ (Lessons)

### –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

```bash
node cleanup.js
```

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —É–¥–∞–ª–∏—Ç **–í–°–ï** –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î!

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞

–í—Å–µ –≤—Ä–µ–º—è –∏–∑ AlfaCRM (Almaty, UTC+5) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ UTC –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î.

–ù–∞–ø—Ä–∏–º–µ—Ä:
- `10:00 Almaty` ‚Üí `05:00 UTC`
- `18:00 Almaty` ‚Üí `13:00 UTC`

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –£–º–Ω—ã–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã

–ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- `paid_count` - –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π
- `paid_till` - –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞
- `balance` - —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å

–°—Ç–∞—Ç—É—Å –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- `active` - –µ—Å–ª–∏ `paid_till` –≤ –±—É–¥—É—â–µ–º
- `expired` - –µ—Å–ª–∏ –¥–∞—Ç–∞ –∏—Å—Ç–µ–∫–ª–∞ –∏–ª–∏ –Ω–µ—Ç –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π

### –ó–∞–Ω—è—Ç–∏—è

–°–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ **–±–ª–∏–∂–∞–π—à–∏–µ 2 –Ω–µ–¥–µ–ª–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π –≥—Ä—É–ø–ø. 
–ù–µ –º–∏–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤—Å—è –∏—Å—Ç–æ—Ä–∏—è –∑–∞–Ω—è—Ç–∏–π –∏–∑ AlfaCRM.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```
Teachers ‚Üí Groups ‚Üí Group Schedules ‚Üí Lessons
            ‚Üì
         Students ‚Üí Student Subscriptions ‚Üí Student-Group Links
            ‚Üì
    Student Balance ‚Üí Transactions & Debts
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. PostgreSQL –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `.env`
3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞: `createdb classmate_central`

### –û—à–∏–±–∫–∞ 401 –æ—Ç AlfaCRM API

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `ALFACRM_EMAIL` –∏ `ALFACRM_API_KEY`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π: `https://–≤–∞—à-—Ñ–∏–ª–∏–∞–ª.s20.online`

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ó–∞–ø—É—Å—Ç–∏—Ç–µ cleanup –∏ –º–∏–≥—Ä–∏—Ä—É–π—Ç–µ –∑–∞–Ω–æ–≤–æ:

```bash
node cleanup.js
node migrate-from-alfacrm.js
```

## –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –ë–î –¥–ª—è –Ω–æ–≤–æ–≥–æ:

```bash
node backup-and-create-new-db.js
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [MULTI_USER_SETUP.md](MULTI_USER_SETUP.md)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
