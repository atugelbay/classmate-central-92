# Database Migrations Guide

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è SmartCRM.

## üìã –û–±–∑–æ—Ä

–í —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤—Å–µ SQL –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ seed –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Classmate Central.

## üì¶ –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã

1. **001_init_schema** - –ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ–º–ø–∞–Ω–∏–∏, —Ä–æ–ª–∏
   - –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏, —Å—Ç—É–¥–µ–Ω—Ç—ã, –≥—Ä—É–ø–ø—ã
   - –£—Ä–æ–∫–∏, –∫–æ–º–Ω–∞—Ç—ã

2. **002_leads_and_rooms** - –õ–∏–¥—ã –∏ –∫–æ–º–Ω–∞—Ç—ã
   - –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–æ–≤ (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã)
   - –¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–Ω–∞—Ç
   - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª–∏–¥–æ–≤

3. **003_finance** - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –º–æ–¥—É–ª—å
   - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π
   - –ë–∞–ª–∞–Ω—Å—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
   - –î–æ–ª–≥–∏
   - –¢–∞—Ä–∏—Ñ—ã

4. **004_subscriptions** - –°–∏—Å—Ç–µ–º–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤
   - –¢–∏–ø—ã –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤
   - –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
   - –ó–∞–º–æ—Ä–æ–∑–∫–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤

5. **005_student_enhancements** - –£–ª—É—á—à–µ–Ω–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏
   - –ò—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
   - –ó–∞–º–µ—Ç–∫–∏ –æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

6. **006_add_multi_tenancy** - –ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ company_id –≤ —Ç–∞–±–ª–∏—Ü—ã
   - –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

7. **006_schedule_and_subscriptions** - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã
   - –£–ª—É—á—à–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
   - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤

8. **007_add_company_to_finance** - –ö–æ–º–ø–∞–Ω–∏–∏ –≤ —Ñ–∏–Ω–∞–Ω—Å–∞—Ö
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ company_id –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã

9. **008_fix_missing_columns** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–ª–æ–Ω–æ–∫

10. **009_add_billing_type** - –¢–∏–ø—ã –±–∏–ª–ª–∏–Ω–≥–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤

11. **010_enhance_subscriptions** - –£–ª—É—á—à–µ–Ω–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤
    - –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—è
    - –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞

12. **011_make_age_nullable** - –í–æ–∑—Ä–∞—Å—Ç –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π

13. **012_add_group_schedule** - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø

14. **013_add_room_to_groups** - –ö–æ–º–Ω–∞—Ç—ã –≤ –≥—Ä—É–ø–ø–∞—Ö

15. **014_add_enrollment** - –ó–∞—á–∏—Å–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—ã

16. **015_add_individual_enrollment** - –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è

17. **016_add_schedule_rule** - –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

18. **017_add_lesson_occurrence** - –í—Ö–æ–∂–¥–µ–Ω–∏—è —É—Ä–æ–∫–æ–≤

19. **018_add_subscription_consumption** - –°–ø–∏—Å–∞–Ω–∏–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤

20. **019_add_invoice_tables** - –¢–∞–±–ª–∏—Ü—ã –∏–Ω–≤–æ–π—Å–æ–≤

21. **020_add_transaction_table** - –¢–∞–±–ª–∏—Ü–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

22. **021_add_rbac_system** - RBAC —Å–∏—Å—Ç–µ–º–∞
    - –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
    - –°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π

23. **022_add_company_to_settings** - –ö–æ–º–ø–∞–Ω–∏–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

24. **023_add_version_for_optimistic_locking** - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

25. **024_add_timezone_to_settings** - –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

26. **025_add_unique_idx_deduction** - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏–π

27. **026_add_email_verification** - Email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
    - –¢–æ–∫–µ–Ω—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
    - –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### Seed Data Files

- **seed_data.sql** - Production-like mock –¥–∞–Ω–Ω—ã–µ (—Ä—É—Å—Å–∫–∏–π/–∫–∏—Ä–∏–ª–ª–∏—Ü–∞)
- **seed_test_data.sql** - –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π/–ª–∞—Ç–∏–Ω–∏—Ü–∞)
- **verify_data.sql** - SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **SEED_DATA_GUIDE.md** - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é mock –¥–∞–Ω–Ω—ã—Ö

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏

–ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ backend —Å–µ—Ä–≤–µ—Ä–∞.

–î–ª—è —Ä—É—á–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é backend
cd backend

# –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
go run cmd/api/main.go
```

### –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

```bash
# –†—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è (production-like)
psql -U postgres -d classmate_central < migrations/seed_data.sql

# –ò–õ–ò –∞–Ω–≥–ª–∏–π—Å–∫–∞—è –≤–µ—Ä—Å–∏—è (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
psql -U postgres -d classmate_central < migrations/seed_test_data.sql
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

```bash
psql -U postgres -d classmate_central < migrations/verify_data.sql
```

## üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

### –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é

–ú–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é. –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞:
```
XXX_description.up.sql
XXX_description.down.sql
```

–ì–¥–µ `XXX` - –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏.

### –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π

–ú–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ `.down.sql` —Ñ–∞–π–ª—ã. –î–ª—è —Ä—É—á–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞:

```sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ .down.sql —Ñ–∞–π–ª–∞
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π

–ú–∏–≥—Ä–∞—Ü–∏–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É `schema_migrations` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

## üê≥ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å Docker

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker Compose:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
docker-compose up -d postgres

# –ü–æ–¥–æ–∂–¥–∞—Ç—å –ø–æ–∫–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞
sleep 5

# –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ backend
# –ò–ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
docker-compose exec postgres psql -U postgres -d classmate_central -f /path/to/migration.sql
```

## üìä –û–±–∑–æ—Ä —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

- `users` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã (–∞–¥–º–∏–Ω—ã, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏)
- `companies` - –ö–æ–º–ø–∞–Ω–∏–∏ (–º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å)
- `roles` - –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `permissions` - –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- `user_roles` - –°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π
- `teachers` - –ü—Ä–æ—Ñ–∏–ª–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
- `students` - –ü—Ä–æ—Ñ–∏–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- `groups` - –£—á–µ–±–Ω—ã–µ –≥—Ä—É–ø–ø—ã
- `rooms` - –ö–ª–∞—Å—Å–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã
- `lessons` - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Ä–æ–∫–∏
- `leads` - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã

### –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã

- `payment_transactions` - –í—Å–µ –∑–∞–ø–∏—Å–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- `student_balance` - –¢–µ–∫—É—â–∏–µ –±–∞–ª–∞–Ω—Å—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- `debt_records` - –î–æ–ª–≥–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- `tariffs` - –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã
- `discounts` - –°–∫–∏–¥–∫–∏

### –¢–∞–±–ª–∏—Ü—ã –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤

- `subscription_types` - –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤
- `student_subscriptions` - –ê–∫—Ç–∏–≤–Ω—ã–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- `subscription_freezes` - –ó–∞–ø–∏—Å–∏ –∑–∞–º–æ—Ä–æ–∑–∫–∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤
- `subscription_consumption` - –ò—Å—Ç–æ—Ä–∏—è —Å–ø–∏—Å–∞–Ω–∏–π
- `lesson_attendance` - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ —É—Ä–æ–∫–æ–≤

### –¢–∞–±–ª–∏—Ü—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏

- `student_activity_log` - –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞
- `student_notes` - –ó–∞–º–µ—Ç–∫–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π –æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö
- `notifications` - –°–∏—Å—Ç–µ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤

### –°–≤—è–∑—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã

- `student_subjects` - –°–≤—è–∑—å —Å—Ç—É–¥–µ–Ω—Ç-–ø—Ä–µ–¥–º–µ—Ç
- `student_groups` - –ß–ª–µ–Ω—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ –≥—Ä—É–ø–ø–∞—Ö
- `lesson_students` - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –Ω–∞ —É—Ä–æ–∫–∏
- `lead_activities` - –ò—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —Å –ª–∏–¥–∞–º–∏
- `lead_tasks` - –ó–∞–¥–∞—á–∏ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å –ª–∏–¥–∞–º–∏

## ‚úÖ Best Practices

1. **–í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ —Å–Ω–∞—á–∞–ª–∞**
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: –≤—ã–ø–æ–ª–Ω–∏—Ç—å `.up.sql`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–∫–∞—Ç: –≤—ã–ø–æ–ª–Ω–∏—Ç—å `.down.sql`
   - –ü–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å: –≤—ã–ø–æ–ª–Ω–∏—Ç—å `.up.sql`

2. **–ü–∏—à–∏—Ç–µ –æ–±—Ä–∞—Ç–∏–º—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏**
   - –ö–∞–∂–¥—ã–π `.up.sql` –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π `.down.sql`
   - –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ–±–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**
   - –û–±–µ—Ä–Ω–∏—Ç–µ DDL –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∫–æ–≥–¥–∞ –≤–æ–∑–º–æ–∂–Ω–æ
   - –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞—Ç–æ–º–∞—Ä–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

4. **–î–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ø–µ—Ä–µ–¥ production –º–∏–≥—Ä–∞—Ü–∏—è–º–∏**
   ```bash
   pg_dump classmate_central > backup_$(date +%Y%m%d_%H%M%S).sql
   ```

5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã**
   - –û–±–Ω–æ–≤–ª—è–π—Ç–µ —ç—Ç–æ—Ç README
   - –î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ —Ñ–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
   - –û–±–Ω–æ–≤–ª—è–π—Ç–µ SEED_DATA_GUIDE.md –µ—Å–ª–∏ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

## üêõ Troubleshooting

### –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend —Å–µ—Ä–≤–µ—Ä–∞

### –û—à–∏–±–∫–∞ "relation already exists"

–ú–∏–≥—Ä–∞—Ü–∏—è —É–∂–µ –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É `schema_migrations`.

### –ù–µ –º–æ–≥—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```
postgres://username:password@host:port/database?sslmode=disable
```

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã seed –¥–∞–Ω–Ω—ã—Ö

–û—á–∏—Å—Ç–∏—Ç–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–Ω–∞—á–∞–ª–∞:
```sql
TRUNCATE TABLE lesson_students, lesson_attendance, student_groups, student_subjects, 
  lessons, groups, students, teachers, leads, rooms, debt_records, payment_transactions, 
  student_balance, tariffs, subscription_freezes, student_subscriptions, subscription_types,
  student_activity_log, student_notes, notifications CASCADE;
```

## üåç –ó–∞–º–µ—Ç–∫–∏ –ø–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º

### Development
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `seed_test_data.sql` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ß–∞—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### Staging
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `seed_data.sql` –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—Ç—Ä–∞–∂–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É production

### Production
- **–ù–ò–ö–û–ì–î–ê** –Ω–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ seed data —Å–∫—Ä–∏–ø—Ç—ã
- –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ staging —Å–Ω–∞—á–∞–ª–∞
- –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –æ–∫–Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [golang-migrate documentation](https://github.com/golang-migrate/migrate)
- [PostgreSQL documentation](https://www.postgresql.org/docs/)
- –°–º. `SEED_DATA_GUIDE.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –ø–æ mock –¥–∞–Ω–Ω—ã–º
